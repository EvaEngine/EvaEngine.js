#!/usr/bin/env babel-node
import { EvaEngine, DI, exceptions, commands } from '../';

const engine = new EvaEngine({
  projectRoot: process.cwd()
}, 'cli');
engine.registerCommands([
  { MakeEntityCommand: commands.MakeEntityCommand }
]);

const logger = DI.get('logger');
global.p = (...args) => {
  logger.debug(...args);
};

(async() => {
  try {
    await engine.runCLI();
  } catch (e) {
    if (e instanceof exceptions.LogicException) {
      if (e instanceof exceptions.FormInvalidateException) {
        return logger.warn(e.getDetails());
      }
      return logger.warn(e.message);
    }
    logger.error(e);
  }
  return true;
})();
